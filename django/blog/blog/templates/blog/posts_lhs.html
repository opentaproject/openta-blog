{% block posts %}
{% load humanize %}
  <div class="OpenTA-post-list">
{% if is_authenticated %} 
  <div class="p-2 bg-gray-200">
   <form method="post" action="{% url 'blog_add_post' %}">
    {% csrf_token %}
    <span class="flex">
    <button class="p-1 text-white bg-blue-400 font-medium rounded me-2 " type="submit">New post: </button>
    <input class="px-2 grow border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-400" type="text" id="title" name="title" placeholder="title ..." required> 
    <input type="hidden" id="visibility" name="visibility" value="{{ visibility }}">
    <input type="hidden" id="author_type" name="author_type" value="{{ author_type}}">
    <input type="hidden" id="author" name="author" value="{{ username }}">
    <input type="hidden" id="category" name="category" value="{{ category_selected }}">
    </span>
</form>
  </div>
{% endif %}

    {% for post in posts %}
      <div>

        {% if post.pk == selected %}
          <div class="OpenTA-post-selected-entry">
		  <div class=" {{ post.textclass }} flex justify-between w-full">
	    <span> 
{% if not post.viewed %}     <i class="fa-solid fa-circle "></i> {% endif %} 
		    <a class="" href="{% url 'blog_index'  post.pk %}"> 
		      <button  id="check{{ post.pk }}"  class=""> <i class="{{ post.bgclass }} far fa-square-check lhs"></i></button>
                <span id="tog{{ post.pk}}" class="selected-post" > <span class="OpenTA-post-title"> {{ post.title | truncatechars:10 | safe }} </span> </span>
		</span> 
		<span class="OpenTA-post-last-modified"> {{ post.author }} {{ post.last_modified | naturaltime }} </span>
              </a>
	    </div>
              <div class="text-xs" > {{ post.body | striptags | truncatechars:200   | safe }} </div>
          </div>

        {% else %}
          <div class="OpenTA-post-entry">
		  <div class=" {{ post.textclass }} flex justify-between w-full">
	      <span> 
{% if not post.viewed %}     <i class="fa-solid fa-circle "></i> {% endif %} 
              <a class="OpenTA-leave-comment-link" href="{% url 'blog_index'  post.pk %}">

		      <button  id="check{{ post.pk }}"  class="OpenTA-hide-button"> <i class=" {{ post.bgclass }} far fa-square "></i>   </button>
                <span id="tog{{ post.pk}}" class="selected-post" > <span class="OpenTA-post-title"> {{ post.title | truncatechars:10 | safe }} </span> </span>
	    </span> 
	    <span class="OpenTA-post-last-modified"> {{ post.author }} {{ post.last_modified | naturaltime }} </span>
              </a>
	    </div> 
              <div class="text-xs"> {{ post.body | truncatechars:200 | safe }} </div>
          </div>
        {% endif %}

      </div>
      </div>
      </div>
    {% endfor %}
  </div>


{% endblock posts %}
